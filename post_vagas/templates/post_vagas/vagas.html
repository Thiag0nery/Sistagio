{% extends 'base.html' %}

{% block title %}<title>Vagas</title> {% endblock %}

{% load static %}
{% block style %}
<link rel="stylesheet" href="{% static 'vagas.css'%}">{% endblock %}
{% block conteudo %}
{% include 'parcias/_header.html' %}
<main class="main">

    <!-- <section class="container-carrossel">
            aaaa<div class="titulo-carrosel">
                <h2 title="carrossel">Olá {{user.first_name}}, Bem vindo ao Sistagio</h2>
                <h5 class="subtitulo-carrosel">No sistagio você encontra tudo que você mais deseja</h5>
            </div> aaa
            <div class="box-carrosel">
                <div class="itens-carrossel">
                    <div class="carousel">
                        <div class="carousel-container">
                          <div class="carousel-slide">
                            <img src="/static/imagens/carrosel1.jpg" alt="Imagem 1">
                            <img src="/static/imagens/carrosel2.jpg" alt="Imagem 2">
                            <img src="/static/imagens/carrosel3.jpg" alt="Imagem 3">
                              <img src="/static/imagens/estudantes.jpg" alt="Imagem 4">

                          </div>
                        </div>
                      </div>
                </div>
                <div class="img-box-carrossel">
                    <img src="/static/imagens/atronautaa-removebg-preview.png" alt="" class="img-carrossel">
                </div>
            </div>
        </section>-->

{% if perfilUsuario.tipo == 'A' %}
<form class="busca" method="GET" action="{% url 'post_vagas:busca' %}">

    <div class="divBusca">
        <h1 class="titleBusca">Busque por novos estagiários!</h1>
        <div class="itensBusca">
            <input type="text" id="txtBusca" placeholder="Buscar..." name="busca" />
            <button id="btnBusca">Buscar</button>
        </div>
    </div>
</form>

<section class="vagas">
    <h1 class="title-container-vagas">Vagas Disponíveis</h1>
    <div class="containerVagas">

        {% for vaga in vagas %}
        <div class="box-vagas">


            <div class="card-vagas">

                <div class="itens-vagas">
                    <h2 class="vaga_name">{{ vaga.vag_nome}}</h2>
                    <h3 class="title-empresa">{{ vaga.vag_usuario_fk.first_name}}</h3>
                    <!-- <h5 class="subtitulo-empresa">Uma empresa de micro-serviços</h5> -->
                    <h5 class="endereco">{{ vaga.vag_endereco}}</h5>
                    <vaga_descricao style="display:none;" id="vaga_descricao">{{vaga.vag_descricao}}</vaga_descricao>
                    <vaga_funcao style="display:none;" id="vaga_funcao">{{vaga.vag_funcao}}</vaga_funcao>
                    <vaga_beneficio style="display:none;" id="vaga_beneficio">{{vaga.vag_beneficio}}</vaga_beneficio>
                </div>
                <div class="itens-btn">
                    <a class=" btn-ver-mais {{vaga.vag_nome}}">Ver Mais</a>
                </div>

            </div>






        </div>

        {% endfor %}


    </div>
</section>

<div class="modal-container">

    <div class="modal">
        <h3 id="vaga-nome"></h3>
        <h3 id="empresa-nome"></h3>
        <div class="modal-texts">
            <div class="itens-vaga">
                <h3 class="title-texts">Requisitos: </h3>
                <h2 id="vaga-descricao"></h2>
            </div>
            <div class="itens_vaga">
                <h5 class="requisitos_vaga"></h5>
            </div>
            <div class="itens-vaga">
              <h3 class="title-texts">Descrição: </h3>
              <h5 id="vaga-funcao"></h5>
            </div>
            <div class="itens-vaga">
                <h3 class="title-texts">Endereço: </h3>
                <h5 id="empresa_endereco"></h5>
            </div>
            <div class="itens-vaga">
                <p class="title-texts">Benefícios:</p>
                <h5 id="vaga-beneficio"></h5>
            </div>  
        </div>
        <form  class="button-candidatar"> <p>Inscreva-se</p></form>
    </div>
</div>
</main>
{%endif%}

{% if perfilUsuario.tipo == 'E' %}

{%endif%}
<script>
    const getElement = (...queries) => document.querySelector(...queries);

    elemento = document.querySelectorAll('.card-vagas');


    var modal = getElement(".modal-container");


    activeModalClass = 'modal-show';

    elemento.forEach(function (elements) {


        elements.addEventListener('click', function () {

            showModal(elements);
        });
    })

    function showModal(element) {
        var nome = element.querySelector("h2");
        var nome_empresa = element.querySelector("h3");
        var endereco = element.querySelector("h5");
        var vaga_descricao = element.querySelector("vaga_descricao");
        var vaga_funcao =element.querySelector("vaga_funcao");
        var vaga_beneficio =element.querySelector("vaga_beneficio");


        document.getElementById("vaga-nome").innerHTML = nome.innerHTML;
        document.getElementById("vaga-funcao").innerHTML = vaga_funcao.innerHTML;
        document.getElementById("vaga-beneficio").innerHTML = vaga_beneficio.innerHTML;
        document.getElementById("vaga-descricao").innerHTML = vaga_descricao.innerHTML;
        document.getElementById("empresa-nome").innerHTML = nome_empresa.innerHTML;
        document.getElementById("empresa_endereco").innerHTML = endereco.innerHTML;

        modal.classList.add(activeModalClass)
    }


    modal.addEventListener('click', (event) => {
        modal.classList.remove(activeModalClass)
    })
</script>
<script>
    var carouselSlide = document.querySelector('.carousel-slide');
    var carouselImages = document.querySelectorAll('.carousel-slide img');

    var counter = 0;
    var slideWidth = carouselImages[0].clientWidth;

    // Configurar o slide inicial
    carouselSlide.style.transform = 'translateX(' + (-slideWidth * counter) + 'px)';

    // Função para avançar o slide
    function nextSlide() {
        if (counter >= carouselImages.length - 1) return;
        counter++;
        carouselSlide.style.transition = 'transform 0.3s ease-in-out';
        carouselSlide.style.transform = 'translateX(' + (-slideWidth * counter) + 'px)';
    }

    // Definir intervalo de tempo para avançar automaticamente
    var interval = setInterval(nextSlide, 2000);

    // Reiniciar o slide no final
    carouselSlide.addEventListener('transitionend', function () {
        if (carouselImages[counter].id === 'last-clone') {
            carouselSlide.style.transition = 'none';
            counter = carouselImages.length - 3;
            carouselSlide.style.transform = 'translateX(' + (-slideWidth * counter) + 'px)';
        }
        if (carouselImages[counter].id === 'first-clone') {
            carouselSlide.style.transition = 'none';
            counter = carouselImages.length - counter;
            carouselSlide.style.transform = 'translateX(' + (-slideWidth * counter) + 'px)';
        }
    });

    // Pausar o carrossel ao passar o mouse
    carouselSlide.addEventListener('mouseenter', function () {
        clearInterval(interval);
    });

    // Retomar o carrossel ao remover o mouse
    carouselSlide.addEventListener('mouseleave', function () {
        interval = setInterval(nextSlide, 3000);
    });
</script>
{% endblock %}